# é˜¿é‡Œäº‘å¿«é€Ÿéƒ¨ç½²æŒ‡å— - geshixiugai.cn

## ğŸ¯ å‰ææ¡ä»¶

âœ… **å·²å®Œæˆ**ï¼š
- é˜¿é‡Œäº‘æœåŠ¡å™¨å·²è´­ä¹°
- å¤‡æ¡ˆå®¡æ ¸å·²é€šè¿‡
- åŸŸå geshixiugai.cn å·²è´­ä¹°å¹¶å®åè®¤è¯

---

## ğŸ“‹ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

```bash
# ä½¿ç”¨ SSH è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP

# è¾“å…¥ root å¯†ç 
```

### æ­¥éª¤ 2ï¼šä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨

æœ‰ä¸¤ç§æ–¹å¼ï¼š

#### æ–¹å¼ 1ï¼šä½¿ç”¨ Gitï¼ˆæ¨èï¼‰

```bash
# åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»£ç 
cd /var/www
git clone https://github.com/jet20002025-hash/geshixiugai.git geshixiugai
cd geshixiugai
```

#### æ–¹å¼ 2ï¼šä½¿ç”¨ SCP ä¸Šä¼ 

åœ¨**æœ¬åœ°ç”µè„‘**ä¸Šè¿è¡Œï¼š

```bash
# ä¸Šä¼ æ•´ä¸ªé¡¹ç›®ç›®å½•
scp -r /Users/zwj/wordæ ¼å¼ä¿®æ”¹å™¨ root@ä½ çš„æœåŠ¡å™¨IP:/var/www/geshixiugai
```

### æ­¥éª¤ 3ï¼šè¿è¡Œéƒ¨ç½²è„šæœ¬

åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼š

```bash
cd /var/www/geshixiugai

# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x deploy_aliyun.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
sudo ./deploy_aliyun.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… å®‰è£… Python 3.12
- âœ… å®‰è£… Nginx
- âœ… åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
- âœ… å®‰è£…ä¾èµ–
- âœ… é…ç½® Nginx
- âœ… é…ç½® Systemd æœåŠ¡
- âœ… å¯åŠ¨æœåŠ¡

### æ­¥éª¤ 4ï¼šé…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
cd /var/www/geshixiugai
nano .env
```

æ ¹æ®ä½ ä½¿ç”¨çš„å­˜å‚¨æ–¹æ¡ˆï¼Œå¡«å…¥ç›¸åº”çš„é…ç½®ï¼š

**å¦‚æœä½¿ç”¨ Supabase Storage**ï¼š
```bash
SUPABASE_URL=https://ä½ çš„é¡¹ç›®ID.supabase.co
SUPABASE_KEY=ä½ çš„service_role key
SUPABASE_BUCKET=word-formatter-storage
```

**å¦‚æœä½¿ç”¨ Cloudflare R2**ï¼š
```bash
R2_ACCOUNT_ID=ä½ çš„Account ID
R2_ACCESS_KEY_ID=ä½ çš„Access Key ID
R2_SECRET_ACCESS_KEY=ä½ çš„Secret Access Key
R2_BUCKET_NAME=word-formatter-storage
R2_ENDPOINT=https://ä½ çš„Account ID.r2.cloudflarestorage.com
```

**æ”¯ä»˜é…ç½®**ï¼ˆå¦‚æœæœ‰ï¼‰ï¼š
```bash
ALIPAY_APP_ID=ä½ çš„æ”¯ä»˜å®AppID
ALIPAY_PRIVATE_KEY=ä½ çš„æ”¯ä»˜å®ç§é’¥
ALIPAY_PUBLIC_KEY=æ”¯ä»˜å®å…¬é’¥
```

ä¿å­˜æ–‡ä»¶ï¼ˆ`Ctrl+O`ï¼Œ`Enter`ï¼Œ`Ctrl+X`ï¼‰ã€‚

### æ­¥éª¤ 5ï¼šé‡å¯æœåŠ¡

```bash
# é‡å¯æœåŠ¡ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ
sudo systemctl restart geshixiugai

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai
```

### æ­¥éª¤ 6ï¼šé…ç½®åŸŸåè§£æ

1. **ç™»å½•é˜¿é‡Œäº‘ DNS æ§åˆ¶å°**
   - è®¿é—®ï¼šhttps://dns.console.aliyun.com/
   - æ‰¾åˆ°åŸŸå `geshixiugai.cn`

2. **æ·»åŠ  A è®°å½•**
   - **è®°å½•ç±»å‹**ï¼šA
   - **ä¸»æœºè®°å½•**ï¼š@
   - **è®°å½•å€¼**ï¼šä½ çš„æœåŠ¡å™¨å…¬ç½‘ IP
   - **TTL**ï¼š600

3. **æ·»åŠ  www è®°å½•**
   - **è®°å½•ç±»å‹**ï¼šA
   - **ä¸»æœºè®°å½•**ï¼šwww
   - **è®°å½•å€¼**ï¼šä½ çš„æœåŠ¡å™¨å…¬ç½‘ IP
   - **TTL**ï¼š600

4. **ç­‰å¾… DNS ç”Ÿæ•ˆ**ï¼ˆé€šå¸¸å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰

### æ­¥éª¤ 7ï¼šé…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼‰

```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦ï¼ˆä¼šè‡ªåŠ¨é…ç½® Nginxï¼‰
sudo certbot --nginx -d geshixiugai.cn -d www.geshixiugai.cn

# æŒ‰ç…§æç¤ºæ“ä½œï¼š
# 1. è¾“å…¥é‚®ç®±åœ°å€
# 2. åŒæ„æœåŠ¡æ¡æ¬¾
# 3. é€‰æ‹©æ˜¯å¦æ¥æ”¶é‚®ä»¶é€šçŸ¥
# 4. ç­‰å¾…éªŒè¯å®Œæˆ
```

### æ­¥éª¤ 8ï¼šæµ‹è¯•è®¿é—®

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- `http://ä½ çš„å…¬ç½‘IP`ï¼ˆåº”è¯¥é‡å®šå‘åˆ° HTTPSï¼‰
- `https://geshixiugai.cn`ï¼ˆå¦‚æœåŸŸåå·²è§£æï¼‰
- `https://geshixiugai.cn/web`ï¼ˆå‰ç«¯é¡µé¢ï¼‰
- `https://geshixiugai.cn/docs`ï¼ˆAPI æ–‡æ¡£ï¼‰

### æ­¥éª¤ 9ï¼šåœ¨ç½‘ç«™åº•éƒ¨æ·»åŠ å¤‡æ¡ˆå·

ä¿®æ”¹å‰ç«¯é¡µé¢ï¼Œæ·»åŠ å¤‡æ¡ˆå·æ˜¾ç¤ºï¼š

```bash
# ç¼–è¾‘å‰ç«¯æ–‡ä»¶
nano /var/www/geshixiugai/frontend/index.html
```

åœ¨é¡µé¢åº•éƒ¨æ·»åŠ ï¼š
```html
<footer style="text-align: center; padding: 20px; color: #666;">
    <p>å¤‡æ¡ˆå·ï¼šä½ çš„å¤‡æ¡ˆå·</p>
</footer>
```

ç„¶åé‡å¯æœåŠ¡ï¼š
```bash
sudo systemctl restart geshixiugai
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u geshixiugai -f

# æŸ¥çœ‹ Nginx æ—¥å¿—
sudo tail -f /var/log/nginx/geshixiugai_error.log
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯åº”ç”¨æœåŠ¡
sudo systemctl restart geshixiugai

# é‡å¯ Nginx
sudo systemctl restart nginx
```

### æ›´æ–°ä»£ç 

```bash
cd /var/www/geshixiugai

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# æ›´æ–°ä¾èµ–
source venv/bin/activate
pip install -r requirements.txt

# é‡å¯æœåŠ¡
sudo systemctl restart geshixiugai
```

---

## âš ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæœåŠ¡æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -u geshixiugai -n 50

# æ£€æŸ¥ Python ç¯å¢ƒ
cd /var/www/geshixiugai
source venv/bin/activate
python -c "import backend.app.main"
```

### é—®é¢˜ 2ï¼š502 Bad Gateway

```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
sudo systemctl status geshixiugai

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
sudo netstat -tlnp | grep 8000

# æ£€æŸ¥ Nginx é…ç½®
sudo nginx -t
```

### é—®é¢˜ 3ï¼šæ–‡ä»¶ä¸Šä¼ å¤±è´¥

- æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡ 50MB
- æ£€æŸ¥å­˜å‚¨é…ç½®æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼š`sudo journalctl -u geshixiugai -f`

### é—®é¢˜ 4ï¼šåŸŸåæ— æ³•è®¿é—®

- æ£€æŸ¥ DNS è§£æï¼š`nslookup geshixiugai.cn`
- æ£€æŸ¥æœåŠ¡å™¨å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ 80/443 ç«¯å£
- æ£€æŸ¥ Nginx é…ç½®ï¼š`sudo nginx -t`

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] è¿è¡Œéƒ¨ç½²è„šæœ¬å®Œæˆç¯å¢ƒé…ç½®
- [ ] é…ç½® .env æ–‡ä»¶ï¼ˆå­˜å‚¨å’Œæ”¯ä»˜é…ç½®ï¼‰
- [ ] æœåŠ¡å·²å¯åŠ¨å¹¶è¿è¡Œæ­£å¸¸
- [ ] é…ç½®åŸŸåè§£æ
- [ ] é…ç½® SSL è¯ä¹¦
- [ ] æµ‹è¯•è®¿é—®ç½‘ç«™
- [ ] æµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [ ] åœ¨ç½‘ç«™åº•éƒ¨æ·»åŠ å¤‡æ¡ˆå·
- [ ] æ›´æ–°æ”¯ä»˜å›è°ƒåœ°å€

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶å®šä½é—®é¢˜
2. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. å‚è€ƒã€Šé˜¿é‡Œäº‘è¿ç§»å®Œæ•´æŒ‡å—.mdã€‹è·å–è¯¦ç»†è¯´æ˜
4. è”ç³»é˜¿é‡Œäº‘æŠ€æœ¯æ”¯æŒ

---

**éƒ¨ç½²å®Œæˆåï¼Œä½ çš„ç½‘ç«™å°†åœ¨ `https://geshixiugai.cn` æ­£å¸¸è¿è¡Œï¼** ğŸ‰


