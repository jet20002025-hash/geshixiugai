# éƒ¨ç½²ä¸‹ä¸€æ­¥æ“ä½œ - .env é…ç½®å®Œæˆ

## âœ… å·²å®Œæˆ

- [x] .env æ–‡ä»¶å·²é…ç½®ï¼ˆOSS é…ç½®ï¼‰

---

## ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

### æ­¥éª¤ 1ï¼šæ‹‰å–æœ€æ–°ä»£ç ï¼ˆç¡®ä¿åŒ…å« OSS æ”¯æŒï¼‰

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼ˆé˜¿é‡Œäº‘æ§åˆ¶å°çš„å¯¹è¯æ¡†é‡Œï¼‰ï¼š

```bash
cd /var/www/geshixiugai
git pull origin main
```

### æ­¥éª¤ 2ï¼šç»§ç»­è¿è¡Œéƒ¨ç½²è„šæœ¬

å¦‚æœä¹‹å‰çš„éƒ¨ç½²è„šæœ¬å·²ç»åœæ­¢ï¼Œé‡æ–°è¿è¡Œï¼š

```bash
sudo ./deploy_aliyun.sh
```

å¦‚æœè„šæœ¬è¿˜åœ¨è¿è¡Œï¼ˆåœåœ¨ .env é…ç½®æ­¥éª¤ï¼‰ï¼ŒæŒ‰ `Enter` ç»§ç»­ã€‚

### æ­¥éª¤ 3ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… é…ç½® Nginx
- âœ… é…ç½® Systemd æœåŠ¡
- âœ… å¯åŠ¨æœåŠ¡

### æ­¥éª¤ 4ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€

éƒ¨ç½²å®Œæˆåï¼Œæ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u geshixiugai -f
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š
```
[Storage] Using Alibaba Cloud OSS
```

---

## ğŸ“‹ å®Œæ•´å‘½ä»¤åºåˆ—

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
cd /var/www/geshixiugai
git pull origin main

# 2. è¿è¡Œéƒ¨ç½²è„šæœ¬
sudo ./deploy_aliyun.sh

# 3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰

# 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai

# 5. æŸ¥çœ‹æ—¥å¿—ç¡®è®¤ä½¿ç”¨äº† OSS
sudo journalctl -u geshixiugai -n 50 | grep Storage
```

---

## ğŸ” éªŒè¯éƒ¨ç½²

### æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai

# åº”è¯¥æ˜¾ç¤ºï¼šActive: active (running)
```

### æ£€æŸ¥å­˜å‚¨é…ç½®

```bash
# æŸ¥çœ‹æ—¥å¿—ï¼Œç¡®è®¤ä½¿ç”¨äº† OSS
sudo journalctl -u geshixiugai -n 50 | grep -i storage

# åº”è¯¥çœ‹åˆ°ï¼š[Storage] Using Alibaba Cloud OSS
```

### æµ‹è¯•è®¿é—®

```bash
# æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://localhost:8000

# æµ‹è¯•å…¬ç½‘è®¿é—®
curl http://121.199.49.1
```

---

## âš ï¸ å¦‚æœé‡åˆ°é—®é¢˜

### é—®é¢˜ 1ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -u geshixiugai -n 100

# æ£€æŸ¥ Python ç¯å¢ƒ
cd /var/www/geshixiugai
source venv/bin/activate
python -c "import backend.app.main"
```

### é—®é¢˜ 2ï¼šå­˜å‚¨è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ .env æ–‡ä»¶é…ç½®
cat /var/www/geshixiugai/.env

# ç¡®è®¤ OSS é…ç½®æ­£ç¡®
# æ£€æŸ¥ AccessKey æ˜¯å¦æ­£ç¡®
# æ£€æŸ¥ Bucket æ˜¯å¦å­˜åœ¨
```

### é—®é¢˜ 3ï¼šNginx é…ç½®é”™è¯¯

```bash
# æµ‹è¯• Nginx é…ç½®
sudo nginx -t

# æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/geshixiugai_error.log
```

---

## ğŸ“ éƒ¨ç½²å®Œæˆå

éƒ¨ç½²æˆåŠŸåï¼Œä¸‹ä¸€æ­¥ï¼š

1. **é…ç½®åŸŸåè§£æ**ï¼ˆå¦‚æœè¿˜æ²¡é…ç½®ï¼‰
   - é˜¿é‡Œäº‘ DNS æ§åˆ¶å°
   - æ·»åŠ  A è®°å½•æŒ‡å‘ 121.199.49.1

2. **é…ç½® SSL è¯ä¹¦**
   ```bash
   sudo apt install -y certbot python3-certbot-nginx
   sudo certbot --nginx -d geshixiugai.cn -d www.geshixiugai.cn
   ```

3. **æµ‹è¯•ç½‘ç«™åŠŸèƒ½**
   - è®¿é—® https://geshixiugai.cn
   - æµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

---

**ç°åœ¨æ‰§è¡Œ `git pull origin main` ç„¶å `sudo ./deploy_aliyun.sh`ï¼** ğŸš€








