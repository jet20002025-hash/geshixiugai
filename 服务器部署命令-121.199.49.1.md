# æœåŠ¡å™¨éƒ¨ç½²å‘½ä»¤ - geshixiugai.cn

## ğŸ–¥ï¸ æœåŠ¡å™¨ä¿¡æ¯

- **å…¬ç½‘ IP**ï¼š121.199.49.1
- **åŸŸå**ï¼šgeshixiugai.cn
- **GitHub ä»“åº“**ï¼šhttps://github.com/jet20002025-hash/geshixiugai

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆå¤åˆ¶ç²˜è´´æ‰§è¡Œï¼‰

### æ­¥éª¤ 1ï¼šè¿æ¥åˆ°æœåŠ¡å™¨

```bash
ssh root@121.199.49.1
```

### æ­¥éª¤ 2ï¼šæ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼ˆä¸€æ¬¡æ€§å¤åˆ¶ï¼‰

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•å¹¶å…‹éš†ä»£ç 
mkdir -p /var/www && cd /var/www
git clone https://github.com/jet20002025-hash/geshixiugai.git geshixiugai
cd geshixiugai

# è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy_aliyun.sh
sudo ./deploy_aliyun.sh
```

### æ­¥éª¤ 3ï¼šé…ç½®ç¯å¢ƒå˜é‡

éƒ¨ç½²è„šæœ¬è¿è¡Œå®Œæˆåï¼Œé…ç½® `.env` æ–‡ä»¶ï¼š

```bash
cd /var/www/geshixiugai
cp env.example .env
nano .env
```

åœ¨ `.env` æ–‡ä»¶ä¸­å¡«å…¥ä½ çš„é…ç½®ï¼š
- Supabase Storage é…ç½®ï¼ˆæˆ– R2/B2ï¼‰
- æ”¯ä»˜é…ç½®ï¼ˆå¦‚æœæœ‰ï¼‰

ä¿å­˜é€€å‡ºï¼ˆ`Ctrl+O`ï¼Œ`Enter`ï¼Œ`Ctrl+X`ï¼‰ã€‚

### æ­¥éª¤ 4ï¼šé‡å¯æœåŠ¡

```bash
sudo systemctl restart geshixiugai
sudo systemctl status geshixiugai
```

### æ­¥éª¤ 5ï¼šé…ç½®åŸŸåè§£æ

1. ç™»å½•é˜¿é‡Œäº‘ DNS æ§åˆ¶å°ï¼šhttps://dns.console.aliyun.com/
2. æ‰¾åˆ°åŸŸå `geshixiugai.cn`
3. æ·»åŠ  A è®°å½•ï¼š
   - **ä¸»æœºè®°å½•**ï¼š@
   - **è®°å½•ç±»å‹**ï¼šA
   - **è®°å½•å€¼**ï¼š121.199.49.1
   - **TTL**ï¼š600
4. æ·»åŠ  www è®°å½•ï¼š
   - **ä¸»æœºè®°å½•**ï¼šwww
   - **è®°å½•ç±»å‹**ï¼šA
   - **è®°å½•å€¼**ï¼š121.199.49.1
   - **TTL**ï¼š600

### æ­¥éª¤ 6ï¼šé…ç½® SSL è¯ä¹¦

ç­‰å¾…åŸŸåè§£æç”Ÿæ•ˆåï¼ˆé€šå¸¸å‡ åˆ†é’Ÿï¼‰ï¼Œæ‰§è¡Œï¼š

```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d geshixiugai.cn -d www.geshixiugai.cn
```

### æ­¥éª¤ 7ï¼šæµ‹è¯•è®¿é—®

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- `http://121.199.49.1`ï¼ˆåº”è¯¥é‡å®šå‘åˆ° HTTPSï¼‰
- `https://geshixiugai.cn`ï¼ˆåŸŸåè§£æç”Ÿæ•ˆåï¼‰
- `https://geshixiugai.cn/web`ï¼ˆå‰ç«¯é¡µé¢ï¼‰
- `https://geshixiugai.cn/docs`ï¼ˆAPI æ–‡æ¡£ï¼‰

---

## ğŸ” éªŒè¯éƒ¨ç½²

### æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
sudo systemctl status geshixiugai

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep 8000

# æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://localhost:8000
curl http://121.199.49.1
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u geshixiugai -f

# æŸ¥çœ‹ Nginx æ—¥å¿—
sudo tail -f /var/log/nginx/geshixiugai_error.log
sudo tail -f /var/log/nginx/geshixiugai_access.log
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### é‡å¯æœåŠ¡

```bash
# é‡å¯åº”ç”¨æœåŠ¡
sudo systemctl restart geshixiugai

# é‡å¯ Nginx
sudo systemctl restart nginx

# é‡æ–°åŠ è½½ Nginx é…ç½®ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
sudo systemctl reload nginx
```

### æ›´æ–°ä»£ç 

```bash
cd /var/www/geshixiugai
git pull
source venv/bin/activate
pip install -r requirements.txt
sudo systemctl restart geshixiugai
```

### æŸ¥çœ‹æœåŠ¡ä¿¡æ¯

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status geshixiugai

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
sudo journalctl -u geshixiugai -f

# æŸ¥çœ‹æœ€è¿‘ 50 æ¡æ—¥å¿—
sudo journalctl -u geshixiugai -n 50
```

---

## âš ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ— æ³•è¿æ¥æœåŠ¡å™¨

```bash
# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦åœ¨çº¿
ping 121.199.49.1

# æ£€æŸ¥ SSH ç«¯å£æ˜¯å¦å¼€æ”¾
telnet 121.199.49.1 22
```

### é—®é¢˜ 2ï¼šæœåŠ¡æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -u geshixiugai -n 100

# æ£€æŸ¥ Python ç¯å¢ƒ
cd /var/www/geshixiugai
source venv/bin/activate
python -c "import backend.app.main"
```

### é—®é¢˜ 3ï¼š502 Bad Gateway

```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
sudo systemctl status geshixiugai

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep 8000

# æ£€æŸ¥ Nginx é…ç½®
sudo nginx -t
```

### é—®é¢˜ 4ï¼šåŸŸåæ— æ³•è®¿é—®

```bash
# æ£€æŸ¥ DNS è§£æ
nslookup geshixiugai.cn

# æ£€æŸ¥æœåŠ¡å™¨å®‰å…¨ç»„ï¼ˆé˜¿é‡Œäº‘æ§åˆ¶å°ï¼‰
# ç¡®ä¿å¼€æ”¾äº† 80 å’Œ 443 ç«¯å£
```

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] å·²è¿æ¥åˆ°æœåŠ¡å™¨ï¼ˆ`ssh root@121.199.49.1`ï¼‰
- [ ] ä»£ç å·²å…‹éš†åˆ° `/var/www/geshixiugai`
- [ ] éƒ¨ç½²è„šæœ¬å·²è¿è¡Œå®Œæˆ
- [ ] `.env` æ–‡ä»¶å·²é…ç½®ï¼ˆå­˜å‚¨å’Œæ”¯ä»˜é…ç½®ï¼‰
- [ ] æœåŠ¡å·²å¯åŠ¨ï¼ˆ`sudo systemctl status geshixiugai`ï¼‰
- [ ] åŸŸåè§£æå·²é…ç½®ï¼ˆA è®°å½•æŒ‡å‘ 121.199.49.1ï¼‰
- [ ] SSL è¯ä¹¦å·²é…ç½®
- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] åœ¨ç½‘ç«™åº•éƒ¨æ·»åŠ äº†å¤‡æ¡ˆå·

---

## ğŸ” å®‰å…¨å»ºè®®

1. **ä¿®æ”¹ SSH ç«¯å£**ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   sudo nano /etc/ssh/sshd_config
   # ä¿®æ”¹ Port 22 ä¸ºå…¶ä»–ç«¯å£
   sudo systemctl restart sshd
   ```

2. **é…ç½®é˜²ç«å¢™**ï¼š
   ```bash
   sudo ufw allow 22/tcp
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   sudo ufw enable
   ```

3. **å®šæœŸæ›´æ–°ç³»ç»Ÿ**ï¼š
   ```bash
   sudo apt update && sudo apt upgrade -y
   ```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

- æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š`é˜¿é‡Œäº‘å¿«é€Ÿéƒ¨ç½²æŒ‡å—.md`
- æŸ¥çœ‹å®Œæ•´æŒ‡å—ï¼š`é˜¿é‡Œäº‘è¿ç§»å®Œæ•´æŒ‡å—.md`
- æŸ¥çœ‹å‡†å¤‡æ¸…å•ï¼š`éƒ¨ç½²å‡†å¤‡æ¸…å•.md`

---

**éƒ¨ç½²å®Œæˆåï¼Œä½ çš„ç½‘ç«™å°†åœ¨ `https://geshixiugai.cn` æ­£å¸¸è¿è¡Œï¼** ğŸ‰




