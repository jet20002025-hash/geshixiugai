# æ”¯ä»˜å®é…ç½®æœªä¿å­˜ - ä¿®å¤

## ðŸ” é—®é¢˜

`.env` æ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ° `ALIPAY` é…ç½®é¡¹ï¼Œè¯´æ˜Žé…ç½®å¯èƒ½ï¼š
1. æ²¡æœ‰æ­£ç¡®ä¿å­˜
2. è¢«æ³¨é‡ŠæŽ‰äº†ï¼ˆä»¥ `#` å¼€å¤´ï¼‰
3. é…ç½®é¡¹åç§°ä¸æ­£ç¡®

---

## ðŸš€ æŽ’æŸ¥æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ£€æŸ¥æ˜¯å¦æœ‰æ³¨é‡ŠæŽ‰çš„é…ç½®

```bash
# æ£€æŸ¥æ˜¯å¦æœ‰æ³¨é‡ŠæŽ‰çš„ ALIPAY é…ç½®
sudo grep -i "alipay" /var/www/geshixiugai/.env
```

### æ­¥éª¤ 2ï¼šæŸ¥çœ‹ .env æ–‡ä»¶å®Œæ•´å†…å®¹

```bash
# æŸ¥çœ‹ .env æ–‡ä»¶å†…å®¹ï¼ˆæ³¨æ„ï¼šä¼šæ˜¾ç¤ºæ•æ„Ÿä¿¡æ¯ï¼‰
sudo cat /var/www/geshixiugai/.env
```

### æ­¥éª¤ 3ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«æ­£ç¡®ä¿å­˜

```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´
ls -lh /var/www/geshixiugai/.env
```

---

## ðŸ”§ ä¿®å¤æ­¥éª¤

### æ–¹æ³• 1ï¼šé‡æ–°ç¼–è¾‘ .env æ–‡ä»¶

```bash
sudo vi /var/www/geshixiugai/.env
```

åœ¨ vi ç¼–è¾‘å™¨ä¸­ï¼š
1. æŒ‰ `G` è·³è½¬åˆ°æ–‡ä»¶æœ«å°¾
2. æŒ‰ `i` è¿›å…¥ç¼–è¾‘æ¨¡å¼
3. æ·»åŠ æ”¯ä»˜å®é…ç½®ï¼ˆç¡®ä¿æ²¡æœ‰ `#` æ³¨é‡Šï¼‰ï¼š

```bash
# æ”¯ä»˜å®æ”¯ä»˜é…ç½®
ALIPAY_APP_ID=ä½ çš„æ”¯ä»˜å®AppID
ALIPAY_PRIVATE_KEY=ä½ çš„åº”ç”¨ç§é’¥ï¼ˆå®Œæ•´å†…å®¹ï¼‰
ALIPAY_PUBLIC_KEY=æ”¯ä»˜å®å…¬é’¥ï¼ˆå®Œæ•´å†…å®¹ï¼‰
ALIPAY_SIGN_TYPE=RSA2
ALIPAY_GATEWAY=https://openapi.alipay.com/gateway.do
BASE_URL=https://geshixiugai.cn
```

**é‡è¦**ï¼š
- ç¡®ä¿ `ALIPAY_APP_ID` ç­‰é…ç½®é¡¹å‰é¢**æ²¡æœ‰** `#` æ³¨é‡Šç¬¦å·
- ç¡®ä¿ç­‰å·å‰åŽæ²¡æœ‰ç©ºæ ¼
- ç¡®ä¿æ¯è¡Œä¸€ä¸ªé…ç½®é¡¹

4. ä¿å­˜é€€å‡ºï¼š
   - æŒ‰ `Esc` é€€å‡ºç¼–è¾‘æ¨¡å¼
   - è¾“å…¥ `:wq` ä¿å­˜é€€å‡º
   - æŒ‰å›žè½¦

### æ–¹æ³• 2ï¼šä½¿ç”¨ echo è¿½åŠ é…ç½®ï¼ˆå¦‚æžœ vi æ“ä½œå›°éš¾ï¼‰

```bash
# æ³¨æ„ï¼šéœ€è¦æ›¿æ¢ä¸ºä½ çš„å®žé™…å€¼
sudo bash -c 'cat >> /var/www/geshixiugai/.env << EOF
# æ”¯ä»˜å®æ”¯ä»˜é…ç½®
ALIPAY_APP_ID=ä½ çš„æ”¯ä»˜å®AppID
ALIPAY_PRIVATE_KEY=ä½ çš„åº”ç”¨ç§é’¥
ALIPAY_PUBLIC_KEY=æ”¯ä»˜å®å…¬é’¥
ALIPAY_SIGN_TYPE=RSA2
ALIPAY_GATEWAY=https://openapi.alipay.com/gateway.do
BASE_URL=https://geshixiugai.cn
EOF'
```

---

## âœ… éªŒè¯é…ç½®å·²ä¿å­˜

ä¿å­˜åŽï¼Œå†æ¬¡æ£€æŸ¥ï¼š

```bash
# æ£€æŸ¥é…ç½®é¡¹æ˜¯å¦å­˜åœ¨
sudo grep "^ALIPAY" /var/www/geshixiugai/.env | sed 's/=.*/=***/'
```

åº”è¯¥çœ‹åˆ°ï¼š
```
ALIPAY_APP_ID=***
ALIPAY_PRIVATE_KEY=***
ALIPAY_PUBLIC_KEY=***
ALIPAY_SIGN_TYPE=***
ALIPAY_GATEWAY=***
```

---

## ðŸ“‹ å®Œæ•´ä¿®å¤æµç¨‹

```bash
# 1. æ£€æŸ¥æ˜¯å¦æœ‰æ³¨é‡ŠæŽ‰çš„é…ç½®
sudo grep -i "alipay" /var/www/geshixiugai/.env

# 2. ç¼–è¾‘ .env æ–‡ä»¶
sudo vi /var/www/geshixiugai/.env
# åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ”¯ä»˜å®é…ç½®ï¼ˆç¡®ä¿æ²¡æœ‰ # æ³¨é‡Šï¼‰ï¼Œä¿å­˜é€€å‡º

# 3. éªŒè¯é…ç½®å·²ä¿å­˜
sudo grep "^ALIPAY" /var/www/geshixiugai/.env | sed 's/=.*/=***/'

# 4. ç¡®ä¿æ–‡ä»¶æƒé™æ­£ç¡®
sudo chown nginx:nginx /var/www/geshixiugai/.env
sudo chmod 600 /var/www/geshixiugai/.env

# 5. é‡å¯æœåŠ¡
sudo systemctl restart geshixiugai

# 6. éªŒè¯é…ç½®
# è®¿é—®ï¼šhttps://geshixiugai.cn/payments/debug/config
```

---

## âš ï¸ é‡è¦æç¤º

1. **ç¡®ä¿é…ç½®é¡¹æ²¡æœ‰è¢«æ³¨é‡Š**ï¼š
   - âŒ é”™è¯¯ï¼š`# ALIPAY_APP_ID=xxx`ï¼ˆæœ‰ `#` æ³¨é‡Šï¼‰
   - âœ… æ­£ç¡®ï¼š`ALIPAY_APP_ID=xxx`ï¼ˆæ²¡æœ‰ `#`ï¼‰

2. **ç¡®ä¿é…ç½®åœ¨æ–‡ä»¶æœ«å°¾**ï¼š
   - ä¸è¦åœ¨æ³¨é‡Šå—ä¸­
   - ç¡®ä¿æ˜¯ç‹¬ç«‹çš„é…ç½®è¡Œ

3. **ä¿å­˜åŽéªŒè¯**ï¼š
   - ä½¿ç”¨ `grep` å‘½ä»¤æ£€æŸ¥é…ç½®æ˜¯å¦å­˜åœ¨
   - ç¡®ä¿é…ç½®æ ¼å¼æ­£ç¡®

---

**å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ³¨é‡ŠæŽ‰çš„é…ç½®ï¼Œç„¶åŽé‡æ–°æ·»åŠ ï¼** ðŸ”§










