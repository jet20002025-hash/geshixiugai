# 反馈功能配置说明

## 功能说明

用户可以通过页面右下角的反馈按钮（💬）提交问题反馈，反馈内容会自动发送到你的邮箱：**522168878@qq.com**

## 配置邮件发送（可选）

### 方式一：使用 QQ 邮箱 SMTP（推荐）

1. **开启 QQ 邮箱 SMTP 服务**
   - 登录 QQ 邮箱：https://mail.qq.com
   - 点击"设置" → "账户"
   - 找到"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务"
   - 开启"POP3/SMTP服务"或"IMAP/SMTP服务"
   - 获取授权码（16位字符，不是QQ密码）

2. **在 Vercel 配置环境变量**

   在 Vercel Dashboard → 项目设置 → Environment Variables 中添加：

   | 变量名 | 值 | 说明 |
   |--------|-----|------|
   | `SMTP_HOST` | `smtp.qq.com` | QQ邮箱SMTP服务器 |
   | `SMTP_PORT` | `587` | SMTP端口（TLS） |
   | `SMTP_USER` | `你的QQ邮箱@qq.com` | 发送邮件的邮箱地址 |
   | `SMTP_PASSWORD` | `你的授权码` | QQ邮箱授权码（不是密码） |

3. **保存并重新部署**
   - 保存环境变量后，Vercel 会自动重新部署
   - 等待 1-2 分钟部署完成

### 方式二：使用其他邮箱服务

#### Gmail
```
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=你的gmail@gmail.com
SMTP_PASSWORD=应用专用密码
```

#### 163邮箱
```
SMTP_HOST=smtp.163.com
SMTP_PORT=25 或 465
SMTP_USER=你的邮箱@163.com
SMTP_PASSWORD=授权码
```

#### 企业邮箱
根据你的企业邮箱服务商提供的SMTP配置填写。

## 未配置 SMTP 的情况

如果**没有配置 SMTP 环境变量**，系统会：
- ✅ 仍然接受用户反馈
- ✅ 在服务器日志中记录反馈内容
- ✅ 返回成功消息给用户（避免用户看到错误）

**注意**：未配置 SMTP 时，反馈内容只会记录在服务器日志中，不会发送邮件。建议尽快配置 SMTP。

## 测试反馈功能

1. 打开网站：https://geshixiugai-app.vercel.app/web/
2. 点击页面右下角的反馈按钮（💬）
3. 填写反馈表单：
   - 反馈主题（必填）
   - 反馈内容（必填，至少10个字符）
   - 姓名和邮箱（可选）
4. 点击"提交反馈"
5. 检查你的邮箱（522168878@qq.com）是否收到反馈邮件

## 邮件内容格式

收到的反馈邮件格式如下：

```
用户反馈信息：

主题：格式修改不正确

内容：
文档中的图片没有居中显示，请修复。

---
用户信息：
姓名：张三
邮箱：zhangsan@example.com
文档ID：abc123...

---
此邮件由格式修改器系统自动发送
```

## 故障排查

### 问题：收不到反馈邮件

1. **检查 SMTP 配置**
   - 确认环境变量已正确设置
   - 确认授权码正确（不是QQ密码）
   - 确认邮箱已开启 SMTP 服务

2. **检查 Vercel 日志**
   - 在 Vercel Dashboard → 项目 → Functions → Logs 查看错误信息
   - 查找 "发送反馈邮件失败" 或 "SMTP 发送失败" 相关错误

3. **测试 SMTP 连接**
   - 可以使用 Python 脚本测试 SMTP 连接是否正常

### 问题：反馈按钮不显示

1. 检查浏览器控制台是否有 JavaScript 错误
2. 确认前端文件已正确部署
3. 清除浏览器缓存后重试

## 安全建议

1. **保护授权码**：不要将 SMTP_PASSWORD 提交到代码仓库
2. **使用环境变量**：所有敏感信息都通过环境变量配置
3. **定期更换授权码**：建议每3-6个月更换一次邮箱授权码

## 后续优化建议

1. **添加邮件模板**：美化邮件格式
2. **添加反馈分类**：问题类型、紧急程度等
3. **添加自动回复**：用户提交反馈后自动发送确认邮件
4. **添加反馈管理后台**：查看和管理所有反馈

