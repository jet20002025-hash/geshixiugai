# 国内访问优化方案

## 问题分析

Vercel 默认部署的域名（*.vercel.app）在中国大陆访问可能：
- ❌ 被墙或访问很慢
- ❌ 需要 VPN 才能访问
- ❌ 用户体验差

## 解决方案（按推荐顺序）

### 方案1: 使用 Cloudflare CDN + 自定义域名（推荐 ⭐⭐⭐⭐⭐）

**优势：**
- ✅ 免费
- ✅ 不需要备案
- ✅ 全球 CDN 加速
- ✅ 国内可访问（通过 Cloudflare 节点）
- ✅ 自动 HTTPS

**配置步骤：**

#### 1. 在 Vercel 添加自定义域名

1. 登录 Vercel Dashboard
2. 进入项目 `geshixiugai-app`
3. 点击 **Settings** → **Domains**
4. 点击 **Add Domain**
5. 输入：`geshixiugai.org`
6. 点击 **Add**
7. Vercel 会显示 DNS 配置信息

#### 2. 在 Cloudflare 配置 DNS

1. 登录 [Cloudflare Dashboard](https://dash.cloudflare.com)
2. 选择域名 `geshixiugai.org`
3. 进入 **DNS** → **Records**
4. 添加/修改以下记录：

   **记录 1:**
   ```
   类型: CNAME
   名称: @
   目标: cname.vercel-dns.com
   代理状态: ✅ 已代理（橙色云朵）
   TTL: Auto
   ```

   **记录 2:**
   ```
   类型: CNAME
   名称: www
   目标: cname.vercel-dns.com
   代理状态: ✅ 已代理（橙色云朵）
   TTL: Auto
   ```

#### 3. 配置 Cloudflare 加速设置

1. 在 Cloudflare Dashboard 中，选择域名
2. **Speed** → **Optimization**
   - 启用 **Auto Minify**（压缩 JS/CSS/HTML）
   - 启用 **Brotli**（压缩算法）

3. **Caching** → **Configuration**
   - Caching Level: **Standard**
   - Browser Cache TTL: **4 hours**

4. **Network**
   - HTTP/2: **启用**
   - HTTP/3 (with QUIC): **启用**
   - 0-RTT Connection Resumption: **启用**

#### 4. 等待生效

- DNS 传播：5 分钟到 24 小时
- 访问：`https://geshixiugai.org`（应该可以访问）

---

### 方案2: 使用 Cloudflare Workers 代理（高级 ⭐⭐⭐⭐）

如果方案1还不够快，可以使用 Cloudflare Workers 作为代理。

**优势：**
- ✅ 更快的国内访问
- ✅ 可以添加缓存
- ✅ 免费额度充足

**实现方式：**

创建 Cloudflare Worker，代理到 Vercel：

```javascript
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})

async function handleRequest(request) {
  const url = new URL(request.url)
  
  // 代理到 Vercel
  const vercelUrl = `https://geshixiugai-app.vercel.app${url.pathname}${url.search}`
  
  const response = await fetch(vercelUrl, {
    method: request.method,
    headers: request.headers,
    body: request.body
  })
  
  return response
}
```

然后在 Cloudflare DNS 中，将域名指向 Worker。

---

### 方案3: 使用国内 CDN（需要备案）⭐⭐⭐

**选项：**
- 又拍云 CDN
- 七牛云 CDN
- 阿里云 CDN

**缺点：**
- ❌ 需要备案
- ❌ 需要付费（通常有免费额度）
- ❌ 配置复杂

---

### 方案4: 使用国内服务器（需要备案）⭐⭐

**选项：**
- 阿里云 ECS
- 腾讯云 CVM
- 华为云 ECS

**缺点：**
- ❌ 必须备案
- ❌ 需要迁移代码
- ❌ 成本更高（¥50-200/月）

---

## 推荐方案：Cloudflare CDN（方案1）

### 为什么推荐？

1. **免费**：Cloudflare 免费计划足够使用
2. **无需备案**：使用国外服务器，不需要备案
3. **国内可访问**：通过 Cloudflare 全球节点，国内可以访问
4. **自动加速**：CDN 自动选择最优节点
5. **简单配置**：只需配置 DNS 记录

### 预期效果

- ✅ 国内用户可以访问 `https://geshixiugai.org`
- ✅ 访问速度提升（通过 CDN 缓存）
- ✅ 自动 HTTPS
- ✅ 不需要 VPN

---

## 快速配置步骤（方案1）

### 第一步：Vercel 添加域名

1. Vercel Dashboard → 项目设置 → Domains
2. 添加：`geshixiugai.org`
3. 复制 Vercel 提供的 DNS 信息

### 第二步：Cloudflare 配置 DNS

1. Cloudflare Dashboard → 选择域名
2. DNS → Records → Add record
3. 添加 CNAME 记录：
   - Name: `@`
   - Target: `cname.vercel-dns.com`
   - Proxy: ✅ 开启（橙色云朵）

### 第三步：等待生效

- 通常 5-30 分钟
- 访问 `https://geshixiugai.org` 测试

---

## 验证访问

配置完成后，测试：

1. **国内访问测试**
   - 访问：`https://geshixiugai.org`
   - 应该可以正常访问（不需要 VPN）

2. **速度测试**
   - 使用 [17CE](https://www.17ce.com/) 测试全国访问速度
   - 或使用 [站长工具](https://tool.chinaz.com/speedtest/) 测试

3. **功能测试**
   - 测试上传模板
   - 测试文档处理
   - 测试预览功能

---

## 如果还是无法访问

### 可能原因：

1. **DNS 未生效**
   - 等待更长时间（最多 24 小时）
   - 使用 [DNS Checker](https://dnschecker.org/) 检查

2. **Cloudflare 节点问题**
   - 尝试清除浏览器缓存
   - 使用不同网络测试

3. **需要更稳定的方案**
   - 考虑使用国内服务器（需要备案）
   - 或使用 Cloudflare Workers 代理

---

## 总结

**最佳方案：使用 Cloudflare CDN + 自定义域名**
- ✅ 免费
- ✅ 无需备案
- ✅ 国内可访问
- ✅ 配置简单

**立即行动：**
1. 在 Vercel 添加域名 `geshixiugai.org`
2. 在 Cloudflare 配置 DNS 记录
3. 等待生效后测试访问

